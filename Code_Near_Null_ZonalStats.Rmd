---
title: "NearFertilizer"
author: "JD Stewart"
date: "2/17/2021"
output: html_document
---

```{r Introduction, echo=FALSE}

# This document contains code for viewing density plots of near-null model results by pixels inside/outside GCO. 

# Reproducibility

#This document can be regenerated using Rmarkdown and the associated R-script (Analyses_Figures.R). This R-script, in combination with the supplementary data files (available online at github.com/thecrobe) also allows for full reproducibility of all the the figures and analyses conducted in R. All other analyses are conducted in ArcMap by ESRI. 
```

# Near Analysis Models 

<div class = "col-md-4">
<br><br> **What Was Tested:** Do crop yields increase from GCOs globally no matter where you are located, e.g. with randomized GCOs? For this interpolated prediction surfaces generated using Bayesian Empirical Krigging were then covered with the global fishnet and zonal statistics (means) were calculated per pixel. Colors for these graphs are derived from Simphiwe Ndzube, Invitation to my Voyage #2 (2019). 
</div>

<div class = "col-md-4">
<br><br> **What This Allows Me To Do:** Identify if yield-distance relationships (near analysis) are a function of location of GCOs relative to specific growing areas like China, USA, or India.
</div>

<div class = "col-md-4">
<br><br> **What Are The Model Assumptions:** None, these are descriptive density plots of model results. 
</div>


```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}
library(ggplot2)
library(dplyr)


#ggplot graphic parameters
theme_justin<-theme_bw() +theme(axis.line = element_line(colour = "black"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank())

```

#Barley
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
barley<-read.csv(file="Near_Null_ZonalStats/Barley_Null_ZS.csv", header=T)
fishnet<-read.csv(file="Fishnets/mapping_GCOfishnet.csv", header=T, fileEncoding="UTF-8-BOM")
x<-inner_join(barley, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=barley_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope")+
  theme_justin
  
#Inside vs Outside GCO 
barley.inside<-filter(x, barley_GCO == "Inside")
barley.outside<-filter(x, barley_GCO == "Outside")
barley.test<-perm.t.test(barley.inside$MEAN,barley.outside$MEAN)
print(barley.test)
```

#Cassava
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
cassava<-read.csv(file="Near_Null_ZonalStats/Cassava_Null_ZS.csv", header=T)
x<-inner_join(cassava, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=cassava_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin

#Inside vs Outside GCO 
cassava.inside<-filter(x, cassava_GCO == "Inside")
cassava.outside<-filter(x, cassava_GCO == "Outside")
cassava.test<-perm.t.test(cassava.inside$MEAN,cassava.outside$MEAN)
print(cassava.test)

```

#Groundnut
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
groundnut<-read.csv(file="Near_Null_ZonalStats/Groundnut_Null_ZS.csv", header=T)

x<-inner_join(groundnut, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=groundnut_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin

#Inside vs Outside GCO 
groundnut.inside<-filter(x, groundnut_GCO == "Inside")
groundnut.outside<-filter(x, groundnut_GCO == "Outside")
groundnut.test<-perm.t.test(groundnut.inside$MEAN,groundnut.outside$MEAN)
print(groundnut.test)
```

#Maize
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
maize<-read.csv(file="Near_Null_ZonalStats/Maize_Null_ZS.csv", header=T)

x<-inner_join(maize, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=maize_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin

#Inside vs Outside GCO 
maize.outside<-filter(x, maize_GCO == "Outside")
maize.inside<-filter(x, maize_GCO == "Inside")
maize.test<-perm.t.test(maize.inside$MEAN,maize.outside$MEAN)
print(maize.test)
```
#Millet
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
millet<-read.csv(file="Near_Null_ZonalStats/Millet_Null_ZS.csv", header=T)

x<-inner_join(millet, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=millet_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin

#Inside vs Outside GCO 
millet.outside<-filter(x, millet_GCO == "Outside")
millet.inside<-filter(x, millet_GCO == "Inside")
millet.test<-perm.t.test(millet.inside$MEAN,millet.outside$MEAN)
print(millet.test)

```

#Rapeseed
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
rapeseed<-read.csv(file="Near_Null_ZonalStats/Rapeseed_Null_ZS.csv", header=T)

x<-inner_join(rapeseed, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)

#plot
ggplot(data, aes(x=MEAN, fill=rapeseed_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin

#Inside vs Outside GCO 
rapeseed.outside<-filter(x, rapeseed_GCO == "Outside")
rapeseed.inside<-filter(x, rapeseed_GCO == "Inside")
rapeseed.test<-perm.t.test(rapeseed.inside$MEAN,rapeseed.outside$MEAN)
print(rapeseed.test)

```

#Rice
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Rice_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=rice_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin
```

#Rye
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Rye_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=rye_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF"))  + xlab("Mean Pixel Slope") +
  theme_justin
```

#Sorghum
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Sorghum_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=sorghum_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin
```

#Soybean
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Soy_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=soybean_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) + xlab("Mean Pixel Slope") +
  theme_justin
```

#Sunflower
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Sunflower_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=sunflower_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) +
  theme_justin
```

#Wheat
```{r,  message=TRUE, warning=FALSE, cache=TRUE, message=FALSE}

#data read-ins
data1<-read.csv(file="Near_Null_ZonalStats/Wheat_Null_ZS.csv", header=T)

x<-inner_join(data1, fishnet)
x[x==0] <- NA
summary(x)
data<-na.omit(x)
#plot
ggplot(data, aes(x=MEAN, fill=wheat_GCO)) +
  geom_density(alpha=0.7) + 
  scale_fill_manual(values = c("#F75C02","#1132BF")) +
  theme_justin
```